
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Testing-HF-1268%3A-Market-Fee-Sharing/">
      
      
        <link rel="next" href="../../integration/Monitoring-accounts/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Overview - Bitshares Core refreshed Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Bitshares Core refreshed Docs" class="md-header__button md-logo" aria-label="Bitshares Core refreshed Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bitshares Core refreshed Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mi4uu/bitshares-core-refreshed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Bitshares Core refreshed Docs" class="md-nav__button md-logo" aria-label="Bitshares Core refreshed Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Bitshares Core refreshed Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mi4uu/bitshares-core-refreshed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Building
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Building
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/BUILD_UBUNTU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu (64-bit) Build and Install Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/BUILD_WIN32/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows development environment setup and build instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/BUILD_WinDevEnv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BUILD WinDevEnv
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/Building-on-macOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BitShares-Core Build Instructions for macOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/Building-on-OS-X/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building on OS X
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SPV
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            SPV
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/spv/SPV/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPV
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Threading
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Threading
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/threading/Threading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threading in BitShares Core
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/Blockchain-Objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blockchain Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/chain-locked-tx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chain locked tx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/P2P-network-protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P2P network protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/StealthTransfers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StealthTransfers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nodes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Nodes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/Delayed-Node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delayed Node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/distributed-access-to-the-bitshares-decentralised-exchange/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Access to the BitShares Decentralised Exchange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/Guide-to-setup-personal-nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run your own decentralised exchange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/HaProxy-and-BitShares/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using BitShares-core behind HaProxy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/Manage-your-nodes-by-using-gnu-screen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage your nodes by using gnu screen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/Memory-Reduction-for-Nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Reduction for Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nodes/Node-Initialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node Initialization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wallet
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Wallet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/CLI-Wallet-Cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphene CLI Wallet Cookbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/HTLC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Import-account-to-cli-wallet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import account to cli wallet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Import-BitShares-0.9.3c-wallets-into-BitShares-2.0-CLI-wallet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import BitShares 0.9.3c wallets into BitShares 2.0 CLI wallet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Plasma---Wallet-API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plasma   Wallet API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-2-Factor-Authentication-Protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet 2 Factor Authentication Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-Argument-Format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Argument Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-Backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Backup Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-Login-Protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Login Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-Merchant-Protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Merchant Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet-Server-Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Server Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Wallet_Full-Nodes_Witness_Nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wallet Full Nodes Witness Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/Web-and-light-wallets-release-procedure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web and light wallets release procedure
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Witnesses
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Witnesses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../witnesses/How-To-become-an-active-witness-in-BitShares-2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To become an active witness in BitShares 2.0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../witnesses/How-to-setup-your-witness-for-test-net-%28Ubuntu-14.04-LTS-64-bit%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to setup your witness for test net (Ubuntu 14.04 LTS 64 bit)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../witnesses/witness-rng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Witness rng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../witnesses/witness-scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Witness scheduler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/DEV_README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DEV README
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/design-issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design issues
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/dpos-slot-tickets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dpos slot tickets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/quick-tips-for-devs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Tips for BitShares Developers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing-BSIP40%3A-Custom-Authorities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing-BSIP81%3A-Simple-Maker-Taker-Fees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing-HF-1268%3A-Market-Fee-Sharing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Tests
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/Monitoring-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring accounts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/Contribution-Guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/Git-Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development / Release / Bugfix Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/Style-Guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Style Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/blacklizard-app-finarch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blacklizard app finarch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/blacklizard-app-ideas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blacklizard app ideas
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TO_BE_SORTED
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            TO_BE_SORTED
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Creating-a-new-FBA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a new FBA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Custom-Authority-Precautions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restricting the Power of Custom Authorities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Custom-Authority-Templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/ElasticSearch-Plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElasticSearch Plugins Suite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/egenesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Egenesis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Howto-import-an-existing-delegate-as-witness-in-BitShares-2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Howto import an existing delegate as witness in BitShares 2.0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Howto-propose-committee-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Howto propose committee actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/private-testnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private testnet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/public-testnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public testnet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/README-debug_node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    README debug node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/resolvable-bitassets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resolvable bitassets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Scripting-websockets-easy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripting websockets easy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/theoretical-theories/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theoretical theories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../to_sort/Websocket-Subscriptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Websocket Subscriptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Tests
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="overview">Overview</h1>
<p>The instructions below are intended to assist with manual testing of changes made to address the issue of <a href="https://github.com/bitshares/bitshares-core/issues/1270">inconsistent call price when MCR is changed</a> in <a href="https://github.com/bitshares/bitshares-core/milestone/16?closed=1">BitShares Core v.3.0.0</a>.</p>
<p>These test instructions should be executed from a command line interface wallet (CLI) that has been <strong>built for your test environment</strong>.  For example, testing performed with the public testnet requires the CLI built for the <a href="https://testnet.bitshares.eu">BitShares Public Testnet</a>.  The following instructions were executed on a private testing environment where BTS was the core token.  These exact instructions may differ on your test environment in the following ways:</p>
<ul>
<li>The core token may be different than "BTS" (e.g. "TEST").  Modify the commands to use your core token symbol.</li>
<li>The account names that are created might already exist in your test environment.  Check for their existence by running <code>get_account ACCOUNT_NAME</code>.  Modify the commands to use alternate account names).</li>
<li>the asset names that are created might already exist in your test environment.  Check for the existence by running <code>get_asset ACCOUNT_NAME</code>.  Modify the commands to use alternate account names).</li>
<li><strong>The output shown in the results below are from a testnet from before HF-1270. The sample output often contains the undesired behavior that is being fixed.</strong> Testing in a "fixed" environment should display the results that reflect the changed MCR as suggested at the end of Step 3 of <a href="#scenario1-step3">Scenario 1</a> and <a href="#scenario2-step3">Scenario 2</a>.</li>
</ul>
<h2 id="unit-tests">Unit Tests</h2>
<p>For reference, the following unit tests that have been prepared to test the fixes (<a href="https://github.com/bitshares/bitshares-core/pull/1324">1324</a>,<a href="https://github.com/bitshares/bitshares-core/pull/1469">1469</a>,<a href="https://github.com/bitshares/bitshares-core/pull/1493">1493</a>) for  the issue (<a href="https://github.com/bitshares/bitshares-core/issues/1270">1270</a>,<a href="https://github.com/bitshares/bitshares-core/issues/1423">1423</a>).</p>
<ul>
<li><a href="https://github.com/bitshares/bitshares-core/blob/bf7ff54d9a17aa43f4663521e371b8c0ddfc2284/tests/tests/market_tests.cpp#L1541">mcr_bug_increase_before1270</a></li>
<li><a href="https://github.com/bitshares/bitshares-core/blob/bf7ff54d9a17aa43f4663521e371b8c0ddfc2284/tests/tests/market_tests.cpp#L1606">mcr_bug_increase_after1270</a></li>
<li><a href="https://github.com/bitshares/bitshares-core/blob/bf7ff54d9a17aa43f4663521e371b8c0ddfc2284/tests/tests/market_tests.cpp#L1672">mcr_bug_decrease_before1270</a></li>
<li><a href="https://github.com/bitshares/bitshares-core/blob/bf7ff54d9a17aa43f4663521e371b8c0ddfc2284/tests/tests/market_tests.cpp#L1742">mcr_bug_decrease_after1270</a></li>
</ul>
<h1 id="initialize-the-test-environment">Initialize the Test Environment</h1>
<p>The following test scenarios portray the interaction of five actors: an account registrar issuer ("nathan"), an asset issuer ("nathan"), a feed publisher ("publisher-a"), and two asset borrowers/traders ("trader-a" and "trader-b").  Each will require their own wallet with their own keys.  Certain steps must be performed by specific actors from their respective wallet.  Each step of the instructions describe which actor is performing that step.  The reader should use the respective actor's wallet.</p>
<table>
<thead>
<tr>
<th>Tip</th>
</tr>
</thead>
<tbody>
<tr>
<td>Testers who prefer convenience over strict separation of keys may prefer to keep the private keys of every actor in a single wallet.</td>
</tr>
</tbody>
</table>
<h2 id="1-registrar-create-a-feed-publisher">1. Registrar: Create a feed publisher</h2>
<table>
<thead>
<tr>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>This step assumes that the registrar account is already created, and that the tester already has the keys of the registrar.</td>
</tr>
</tbody>
</table>
<p>Create the account of a publisher called "publisher-a"</p>
<pre><code>unlocked &gt;&gt;&gt; suggest_brain_key
suggest_brain_key 
{
"brain_priv_key": "...",
  "wif_priv_key": "...,
  "pub_key": "BTS5RP4bVx2utcnoq1J9eSDFFZu3izmMqvZtGors4ctL1ar9Hy8q9"
}
unlocked &gt;&gt;&gt; suggest_brain_key 
suggest_brain_key 
{
  "brain_priv_key": "...",
  "wif_priv_key": "...",
  "pub_key": "BTS7HbpzSg89bKkuWhyCpd3V57QBTtRRWupLgVgDGwisikd9W4XD2"
}

register_account(string name, public_key_type owner, public_key_type active, string registrar_account, string referrer_account, uint32_t referrer_percent, bool broadcast)

register_account publisher-a BTS5RP4bVx2utcnoq1J9eSDFFZu3izmMqvZtGors4ctL1ar9Hy8q9 BTS7HbpzSg89bKkuWhyCpd3V57QBTtRRWupLgVgDGwisikd9W4XD2 nathan nathan 0 true
</code></pre>
<p>Give the single feed publisher some core tokens</p>
<pre><code>transfer nathan publisher-a 1000 BTS "" true
</code></pre>
<h2 id="2-issuer-create-the-asset">2. Issuer: Create the asset</h2>
<p>Create a bitasset as described in the <a href="docs.bitshares.org/bitshares/tutorials/mpa-create-manual.html">reference instructions</a></p>
<pre><code>create_asset &quot;nathan&quot; &quot;TESTUSDA&quot; 4 {&quot;max_supply&quot;:&quot;1000000000000000&quot;,&quot;market_fee_percent&quot;:0,&quot;max_market_fee&quot;:&quot;1000000000000000&quot;,&quot;issuer_permissions&quot;:161,&quot;flags&quot;:0,&quot;core_exchange_rate&quot;:{&quot;base&quot;:{&quot;amount&quot;:1,&quot;asset_id&quot;:&quot;1.3.0&quot;},&quot;quote&quot;:{&quot;amount&quot;:1,&quot;asset_id&quot;:&quot;1.3.1&quot;}},&quot;whitelist_authorities&quot;:[],&quot;blacklist_authorities&quot;:[],&quot;whitelist_markets&quot;:[],&quot;blacklist_markets&quot;:[],&quot;description&quot;:&quot;&quot;,&quot;extensions&quot;:[]} {} false
</code></pre>
<p>Specify who can publish feeds</p>
<pre><code>update_asset_feed_producers TESTUSDA ["publisher-a"] false

unlocked &gt;&gt;&gt; update_asset_feed_producers TESTUSDA ["publisher-a"] true
update_asset_feed_producers TESTUSDA ["publisher-a"] true
{
  "ref_block_num": 23131,
  "ref_block_prefix": 1301299163,
  "expiration": "2019-03-12T21:18:55",
  "operations": [[
      13,{
        "fee": {
          "amount": 50000000,
          "asset_id": "1.3.0"
        },
        "issuer": "1.2.17",
        "asset_to_update": "1.3.1",
        "new_feed_producers": [
          "1.2.22"
        ],
        "extensions": []
      }
    ]
  ],
  "extensions": [],
  "signatures": [
        "201cd18934e5bfece04ca2f88f66e7832998db8f9214810eefdb6662d2519b17b73a469a5d404c90f3df1eacdcdb219882039756ea2e1ffdcc2ab52f9dccbde052"
  ]
}


unlocked &gt;&gt;&gt; get_bitasset_data TESTUSDA
get_bitasset_data TESTUSDA
{
  "id": "2.4.0",
  "feeds": [[
      "1.2.22",[
        "1970-01-01T00:00:00",{
          "settlement_price": {
            "base": {
              "amount": 0,
              "asset_id": "1.3.0"
            },
            "quote": {
              "amount": 0,
              "asset_id": "1.3.0"
            }
          },
          "maintenance_collateral_ratio": 1750,
          "maximum_short_squeeze_ratio": 1500,
          "core_exchange_rate": {
            "base": {
              "amount": 0,
              "asset_id": "1.3.0"
            },
            "quote": {
              "amount": 0,
              "asset_id": "1.3.0"
            }
          }
        }
      ]
    ]
  ],
  "current_feed": {
    "settlement_price": {
      "base": {
        "amount": 0,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 0,
        "asset_id": "1.3.0"
      }
    },
    "maintenance_collateral_ratio": 1750,
    "maximum_short_squeeze_ratio": 1500,
    "core_exchange_rate": {
      "base": {
        "amount": 0,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 0,
        "asset_id": "1.3.0"
      }
    }
  },
  "current_feed_publication_time": "2019-03-12T21:18:25",
  "options": {
    "feed_lifetime_sec": 86400,
    "minimum_feeds": 1,
    "force_settlement_delay_sec": 86400,
    "force_settlement_offset_percent": 0,
    "maximum_force_settlement_volume": 2000,
    "short_backing_asset": "1.3.0",
    "extensions": []
  },
  "force_settled_volume": 0,
  "is_prediction_market": false,
  "settlement_price": {
    "base": {
      "amount": 0,
      "asset_id": "1.3.0"
    },
    "quote": {
      "amount": 0,
      "asset_id": "1.3.0"
    }
  },
  "settlement_fund": 0
}


unlocked &gt;&gt;&gt; get_object 2.4.0
get_object 2.4.0
[{
    "id": "2.4.0",
    "asset_id": "1.3.1",
    "feeds": [[
        "1.2.22",[
          "1970-01-01T00:00:00",{
            "settlement_price": {
              "base": {
                "amount": 0,
                "asset_id": "1.3.0"
              },
              "quote": {
                "amount": 0,
                "asset_id": "1.3.0"
              }
            },
            "maintenance_collateral_ratio": 1750,
            "maximum_short_squeeze_ratio": 1500,
            "core_exchange_rate": {
              "base": {
                "amount": 0,
                "asset_id": "1.3.0"
              },
              "quote": {
                "amount": 0,
                "asset_id": "1.3.0"
              }
            }
          }
        ]
      ]
    ],
    "current_feed": {
      "settlement_price": {
        "base": {
          "amount": 0,
          "asset_id": "1.3.0"
        },
        "quote": {
          "amount": 0,
          "asset_id": "1.3.0"
        }
      },
      "maintenance_collateral_ratio": 1750,
      "maximum_short_squeeze_ratio": 1500,
      "core_exchange_rate": {
        "base": {
          "amount": 0,
          "asset_id": "1.3.0"
        },
        "quote": {
          "amount": 0,
          "asset_id": "1.3.0"
        }
      }
    },
    "current_feed_publication_time": "2019-03-12T21:18:25",
    "options": {
      "feed_lifetime_sec": 86400,
      "minimum_feeds": 1,
      "force_settlement_delay_sec": 86400,
      "force_settlement_offset_percent": 0,
      "maximum_force_settlement_volume": 2000,
      "short_backing_asset": "1.3.0",
      "extensions": []
    },
    "force_settled_volume": 0,
    "is_prediction_market": false,
    "settlement_price": {
      "base": {
        "amount": 0,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 0,
        "asset_id": "1.3.0"
      }
    },
    "settlement_fund": 0,
    "asset_cer_updated": false,
    "feed_cer_updated": false
  }
]

unlocked &gt;&gt;&gt; get_object 2.3.1
get_object 2.3.1
[{
    "id": "2.3.1",
    "current_supply": 0,
    "confidential_supply": 0,
    "accumulated_fees": 0,
    "fee_pool": 250000000
  }
]
</code></pre>
<h2 id="3-feed-publisher-publish-initial-feed">3. Feed Publisher: Publish initial feed</h2>
<p>20 BTS per 1 USD, MCR 1.75, MSSR of 1.10 (mimicing mcr_bug_increase_before1270)</p>
<p>= 20*10^5 satoshis of BTS per 1 * 10^4 satoshis of USD
= 2000000 BTS-satoshis per 10000 USD-satoshis</p>
<p>asset.cpp price_feed::is_for() insists that the prices have the asset as the base asset</p>
<pre><code>publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":1750,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":1900000,"asset_id":"1.3.0"}}} true
{
"ref_block_num": 23950,
"ref_block_prefix": 437340707,
"expiration": "2019-03-12T22:34:10",
"operations": [[
      19,{
        "fee": {
          "amount": 100000,
          "asset_id": "1.3.0"
        },
        "publisher": "1.2.22",
        "asset_id": "1.3.1",
        "feed": {
          "settlement_price": {
            "base": {
              "amount": 10000,
              "asset_id": "1.3.1"
            },
            "quote": {
              "amount": 2000000,
              "asset_id": "1.3.0"
            }
          },
          "maintenance_collateral_ratio": 1750,
          "maximum_short_squeeze_ratio": 1100,
          "core_exchange_rate": {
            "base": {
              "amount": 10000,
              "asset_id": "1.3.1"
            },
            "quote": {
              "amount": 1900000,
              "asset_id": "1.3.0"
            }
          }
        },
        "extensions": []
      }
    ]
  ],
  "extensions": [],
  "signatures": [
        "1f7190ea8b60a9c3c22d43917c426abbd4134a5b7a95e65353eaa2b46d57c452916e9f1db9ffe4f7b81506e5eb0b01b6f163061c49ba8b477027c201d1b10443a6"
  ]
}

unlocked &gt;&gt;&gt; get_bitasset_data TESTUSDA
get_bitasset_data TESTUSDA
{
"id": "2.4.0",
"feeds": [[
      "1.2.22",[
        "2019-03-12T22:33:40",{
          "settlement_price": {
            "base": {
              "amount": 10000,
              "asset_id": "1.3.1"
            },
            "quote": {
              "amount": 2000000,
              "asset_id": "1.3.0"
            }
          },
          "maintenance_collateral_ratio": 1750,
          "maximum_short_squeeze_ratio": 1100,
          "core_exchange_rate": {
            "base": {
              "amount": 10000,
              "asset_id": "1.3.1"
            },
            "quote": {
              "amount": 1900000,
              "asset_id": "1.3.0"
            }
          }
        }
      ]
    ]
],
  "current_feed": {
    "settlement_price": {
      "base": {
        "amount": 10000,
        "asset_id": "1.3.1"
      },
      "quote": {
        "amount": 2000000,
        "asset_id": "1.3.0"
      }
    },
    "maintenance_collateral_ratio": 1750,
    "maximum_short_squeeze_ratio": 1100,
    "core_exchange_rate": {
      "base": {
        "amount": 10000,
        "asset_id": "1.3.1"
      },
      "quote": {
        "amount": 1900000,
        "asset_id": "1.3.0"
      }
    }
  },
  "current_feed_publication_time": "2019-03-12T22:33:40",
  "options": {
    "feed_lifetime_sec": 86400,
    "minimum_feeds": 1,
    "force_settlement_delay_sec": 86400,
    "force_settlement_offset_percent": 0,
    "maximum_force_settlement_volume": 2000,
    "short_backing_asset": "1.3.0",
    "extensions": []
  },
  "force_settled_volume": 0,
  "is_prediction_market": false,
  "settlement_price": {
    "base": {
      "amount": 0,
      "asset_id": "1.3.0"
    },
    "quote": {
      "amount": 0,
      "asset_id": "1.3.0"
    }
  },
  "settlement_fund": 0
}
</code></pre>
<h2 id="4-create-borrowerstraders">4. Create Borrowers/Traders</h2>
<p>Give some accounts enough collateral asset to borrow the asset into existence, and to place orders for the asset</p>
<h3 id="trader-a">Trader A</h3>
<h4 id="trader-a-create-keys">Trader A: Create keys</h4>
<pre><code>unlocked &gt;&gt;&gt; suggest_brain_key 
suggest_brain_key 
{
  "brain_priv_key": "...",
  "wif_priv_key": "...",
  "pub_key": "BTS7B52d2ToTbG7hLqtCXznCrHfB1uHj1tfi3RnPX39MXDVcQvaxY"
}
unlocked &gt;&gt;&gt; suggest_brain_key 
suggest_brain_key 
{
  "brain_priv_key": "...",
  "wif_priv_key": "...",
  "pub_key": "BTS7ubVaqr9sCcEn7RRE714UriqMXWxouu5AteEcYzgBg2XDJrWL1"
}
</code></pre>
<h4 id="registrar-register-trader-a">Registrar: Register Trader A</h4>
<p>Register the account of trader-a</p>
<pre><code>register_account trader-a BTS7B52d2ToTbG7hLqtCXznCrHfB1uHj1tfi3RnPX39MXDVcQvaxY BTS7ubVaqr9sCcEn7RRE714UriqMXWxouu5AteEcYzgBg2XDJrWL1 nathan nathan 0 true
</code></pre>
<p>Transfer core tokens to trader-a</p>
<pre><code>transfer nathan trader-a 10000 BTS "" true
</code></pre>
<h3 id="create-trader-b">Create Trader B</h3>
<h4 id="trader-b-create-keys">Trader B: Create keys</h4>
<pre><code>unlocked &gt;&gt;&gt; suggest_brain_key 
suggest_brain_key 
{
  "brain_priv_key": "...",
  "wif_priv_key": "...",
  "pub_key": "BTS6fBqA4pGBXoorHQMcikspLwuZDRMdoXuZeUgsuRx6Ui6Rd3oVw"
}

unlocked &gt;&gt;&gt; suggest_brain_key 
suggest_brain_key 
{
  "brain_priv_key": "...",
  "wif_priv_key": "...",
  "pub_key": "BTS5ez6PFW7gSnZmX2x18cX5swKL4S2TH3zPH51HUKXhVbNVD9UCk"
}
</code></pre>
<h4 id="registrar-register-trader-b">Registrar: Register Trader B</h4>
<p>Register the account of trader-b</p>
<pre><code>register_account trader-b BTS6fBqA4pGBXoorHQMcikspLwuZDRMdoXuZeUgsuRx6Ui6Rd3oVw BTS5ez6PFW7gSnZmX2x18cX5swKL4S2TH3zPH51HUKXhVbNVD9UCk nathan nathan 0 true
</code></pre>
<p>Transfer core tokens to trader-b</p>
<pre><code>transfer nathan trader-b 5000 BTS "" true
</code></pre>
<h1 id="scenario-1-increased-mcr-should-initiate-a-margin-call">Scenario 1: Increased MCR should initiate a margin call</h1>
<p>This scenario is similar to mcr_bug_increase_before1270 and mcr_bug_increase_after1270 where an increase of the MCR should make outstanding loans, which were initially well collateralized, to become undercollateralized and available for automatic sale of the collateral by the blockchain.</p>
<h2 id="1-trader-a-trader-a-borrows-at-cr-of-18">1. Trader A: Trader A Borrows at CR of 1.8</h2>
<p>Trader A will borrow at CR of 1.8 using 1000 BTS.  Given the published feed price of 20 BTS for 1 USD, 1000 BTS can purchase 27.78 USD --&gt; 1000000 BTS-satoshis for 277800 USD-satoshis.</p>
<pre><code>unlocked &gt;&gt;&gt; borrow_asset trader-a 27.78 TESTUSDA 1000 true
borrow_asset trader-a 27.78 TESTUSDA 1000 true
1517481ms th_a       wallet.cpp:1975               borrow_asset         ] broadcast: true 
{
  "ref_block_num": 24514,
  "ref_block_prefix": 3807515098,
  "expiration": "2019-03-12T23:25:45",
  "operations": [[
      3,{
        "fee": {
          "amount": 2000000,
          "asset_id": "1.3.0"
        },
        "funding_account": "1.2.23",
        "delta_collateral": {
          "amount": 100000000,
          "asset_id": "1.3.0"
        },
        "delta_debt": {
          "amount": 277800,
          "asset_id": "1.3.1"
        },
        "extensions": []
      }
    ]
  ],
  "extensions": [],
  "signatures": [
"1f5cec798432e5297f1b26023506a77a1af6e6d7c8c63223adcb633d59e8f9e3706294f25b85a9e88b00ac10f2a18a91a3f312db56ce526a02e2f016a1a6c44593"
  ]
}

unlocked &gt;&gt;&gt; list_account_balances trader-a

list_account_balances trader-a
8980 BTS
27.7800 TESTUSDA
</code></pre>
<h2 id="2-trader-b-trader-b-borrows-at-cr-of-20">2. Trader B: Trader B Borrows at CR of 2.0</h2>
<p>Trader B will borrow at CR of 2.0 using 200 BTS.  Given the published feed price of 20 BTS for 1 USD, 200 BTS can purchase 5 USD --&gt; 1000000 BTS-satoshis for 277800 USD-satoshis.</p>
<pre><code>unlocked &gt;&gt;&gt; borrow_asset trader-b 5.0 TESTUSDA 200 true
borrow_asset trader-b 5.0 TESTUSDA 200 true
2139269ms th_a       wallet.cpp:1975               borrow_asset         ] broadcast: true 
{
  "ref_block_num": 24628,
  "ref_block_prefix": 1706587157,
  "expiration": "2019-03-12T23:36:05",
  "operations": [[
  3,{
    "fee": {
      "amount": 2000000,
      "asset_id": "1.3.0"
    },
    "funding_account": "1.2.24",
    "delta_collateral": {
      "amount": 20000000,
      "asset_id": "1.3.0"
    },
    "delta_debt": {
      "amount": 50000,
      "asset_id": "1.3.1"
    },
    "extensions": []
  }
]
  ],
  "extensions": [],
"signatures": [
"1f4ee4b7bfb12db78c4f11554c5234613d73aca4439e11023cd84a1398d1e492d4604712a60cce8afffaac937c12b014e4fc4db5d253da7acb3c5d80761c320328"
]
}

unlocked &gt;&gt;&gt; list_account_balances trader-b
list_account_balances trader-b
4780 BTS
5 TESTUSDA
</code></pre>
<h2 id="3-feed-publisher-changes-mcr-to-20"><div id="scenario1-step3" /> 3. Feed Publisher: Changes MCR to 2.0</h2>
<p>The feed producer changes the MCR to 2.0 while not changing the price feed</p>
<pre><code>publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":2000,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":1900000,"asset_id":"1.3.0"}}} true
</code></pre>
<p>No changes will be visible by inspecting the order book with <code>get_order_book</code></p>
<p><strong>Before HF1270</strong>, no changes to the debt nor collateral of loans will be apparent by inspecting the loans with <code>get_call_orders</code>.</p>
<p><strong>After post-HF1270</strong>, no changes to the debt nor collateral of loans will be apparent by inspecting the loans with <code>get_call_orders</code>.  The <code>call_price</code> field of every loan will always appear with an effective price of 1.0 after the hardfork.  The call_price of the bitasset is now left as a calculation to client software to calculate.  The call price of the bitasset denominated in the collateral token (e.g. bitCNY/BTS) should be calculated as</p>
<p>call_price = (collateral &times; MCR) &div; debt</p>
<h2 id="4-feed-publisher-reset-the-mcr-to-175">4. Feed Publisher: Reset the MCR to 1.75</h2>
<pre><code>publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":1750,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":1900000,"asset_id":"1.3.0"}}} true
</code></pre>
<h1 id="scenario-2-triggered-margin-calls-should-disappear-because-of-mcr-decrease">Scenario 2: Triggered Margin Calls Should Disappear because of MCR decrease</h1>
<h2 id="overview_1">Overview</h2>
<p>Decreasing the MPA-price of the collateral is the same as increasing the Collateral-Price of the MPA</p>
<p>This scenario is similar to mcr_bug_decrease_before1270 and mcr_bug_decrease_after1270: the example calls for a two-steps:</p>
<ol>
<li>The original to change from 1 USD exchanging for 1 BTS to 1 USD exchanging for 1.5 BTS (i.e. the collateral loses 50% of its original USD-value).  <strong>This should trigger the initiation of a margin call.</strong></li>
</ol>
<hr />
<p><strong>Example</strong></p>
<p>If the original price is 20 BTS for 1 TESTUSDA then decreasing the collateral by 50% means that the new price feed should be 30 BTS for 1 TESTUSDA.</p>
<p>The first loan from the blockchain had a CR of (1000 BTS * {1 TESTUSDA / 20 BTS}) / (27.78 TESTUSDA) = 1.80.  After the price feed up from Step 1, it will only have a collateral ratio of (1000 BTS * {1 TESTUSDA / 30 BTS}) / (27.78 TESTUSDA) = 1.20.  Since the CR &lt; Stage 1 MCR of 1.75, a margin call should be triggered.</p>
<p>The second loan from the blockchain had a CR of (200 BTS * {1 TESTUSDA / 20 BTS}) / (5 TESTUSDA) = 2.00.  After the price feed up from Step 1, it will only have a collateral ratio of (200 BTS * {1 TESTUSDA / 30 BTS}) / (5 TESTUSDA) = 1.33.  Since the CR &lt; Stage 1 MCR of 1.75, a margin call should be triggered.</p>
<hr />
<ol>
<li>The original MCR is reduced from 1.75 to 1.1.  <strong>This should cancel the initiated margin call.</strong></li>
</ol>
<hr />
<p><strong>Example</strong></p>
<p>The first loan's CR of 1.20 &gt; Stage 2 MCR which should cancel the unfilled margin call.</p>
<p>The second loan's CR of 1.33 &gt; Stage 2 MCR which should cancel the unfilled margin call.</p>
<hr />
<h2 id="1-feed-publisher-change-the-feed-price">1. Feed Publisher: Change the feed price</h2>
<p>The initial published price is 20 BTS for 1 TESTUSDA.  This should be changed such that the collateral is worth 50% less which means that the new price feed should be 30 BTS for 1 TESTUSDA.</p>
<p>30 BTS per 1 USD
= 30*10^5 satoshis of BTS per 1 * 10^4 satoshis of USD
= 3000000 BTS-satoshis per 10000 USD-satoshis</p>
<p>The CER will also be adjusted to 95% of the feed price: 28.5 BTS per 1 USD = 2850000 BTS-satoshis per 10000 USD-satoshis</p>
<pre><code>publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":3000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":1750,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2850000,"asset_id":"1.3.0"}}} true
</code></pre>
<p>Check the order book to see for order arising from the initiation of margin calls on the two loans</p>
<pre><code>unlocked &gt;&gt;&gt; get_call_orders TESTUSDA 3
get_call_orders TESTUSDA 3
[{
    "id": "1.8.0",
    "borrower": "1.2.23",
    "collateral": 100000000,
    "debt": 277800,
    "call_price": {
      "base": {
        "amount": 2000000,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 9723,
        "asset_id": "1.3.1"
      }
    }
  },{
    "id": "1.8.1",
    "borrower": "1.2.24",
    "collateral": 20000000,
    "debt": 50000,
    "call_price": {
      "base": {
        "amount": 1600,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 7,
        "asset_id": "1.3.1"
      }
    }
  }
]
</code></pre>
<p><strong>Before</strong></p>
<pre><code>list_account_balances trader-a
8980 BTS
27.7800 TESTUSDA


unlocked &gt;&gt;&gt; list_account_balances trader-b
list_account_balances trader-b
4780 BTS
5 TESTUSDA
</code></pre>
<p><strong>After</strong></p>
<pre><code>list_account_balances trader-a
8980 BTS
27.7800 TESTUSDA


list_account_balances trader-b
4940 BTS
0 TESTUSDA


get_call_orders TESTUSDA 5
[{
    "id": "1.8.0",
    "borrower": "1.2.23",
    "collateral": 83500000,
    "debt": 227800,
    "call_price": {
      "base": {
        "amount": 1670000,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 7973,
        "asset_id": "1.3.1"
      }
    }
  },{
    "id": "1.8.1",
    "borrower": "1.2.24",
    "collateral": 20000000,
    "debt": 50000,
    "call_price": {
      "base": {
        "amount": 1600,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 7,
        "asset_id": "1.3.1"
      }
    }
</code></pre>
<p>The order had a fee of 5 BTS</p>
<pre><code>2019-03-13T12:54:05 fill_order_operation trader-b fee: 0 BTS 
2019-03-13T12:54:05 limit_order_create_operation trader-b fee: 5 BTS   result: 1.7.0


100000000 BTS-satoshis - 83500000 BTS-satoshis = 1000.00000 - 835.00000 BTS = 165 BTS --&gt; 33 BTS per 1 USD which is the median published price of 30 BTS per 1 USD times the MSSR of 1.1
</code></pre>
<p>The sale completed and is not sitting on the book.  Trader B sold his MPA (5 TESTUSDA) in exchange for 160 BTS + 5 BTS (fee).</p>
<h2 id="2-feed-publisher-change-the-mcr-ratio">2. Feed Publisher: Change the MCR ratio</h2>
<pre><code>publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":3000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":1100,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2850000,"asset_id":"1.3.0"}}} true
</code></pre>
<h2 id="3-trader-b-place-an-order"><div id="scenario2-step3" /> 3. Trader B: Place an order</h2>
<pre><code>unlocked &gt;&gt;&gt; list_account_balances trader-a
list_account_balances trader-a
8980 BTS
27.7800 TESTUSDA

unlocked &gt;&gt;&gt; list_account_balances trader-b
list_account_balances trader-b
4720 BTS
5 TESTUSDA
</code></pre>
<p>Place a 25-second fill-or-kill order to sell 5 USD at the current feed price of 30 BTS for 1 USD</p>
<pre><code>sell_asset trader-b 5 TESTUSDA 150 BTS 25 true false
</code></pre>
<p>Checking the account history of trader-b</p>
<pre><code>get_account_history trader-b 5
2019-03-13T12:54:05 fill_order_operation trader-b fee: 0 BTS 
2019-03-13T12:54:05 limit_order_create_operation trader-b fee: 5 BTS   result: 1.7.0
</code></pre>
<p>The limit order, which had a fee of 5 BTS, was filled immediately.  Yet this alone does not indicate how much of the order was filled.</p>
<p>Check the balances after the sell order is placed.</p>
<pre><code>unlocked &gt;&gt;&gt; list_account_balances trader-a                      
list_account_balances trader-a
8980 BTS
27.7800 TESTUSDA
</code></pre>
<p>There is no change to the liquid balance of <code>trader-a</code>.</p>
<pre><code>unlocked &gt;&gt;&gt; list_account_balances trader-b
list_account_balances trader-b
4880 BTS
0 TESTUSDA
</code></pre>
<p>The account of trader-b has 0 TESTUSDA and his balance of BTS has increased to 4880.  The net increase of BTS is 160 after accounting for the order fee fee of 5 BTS.  The sale was for 165 BTS for 5 TESTUSDA which is equivalent to 33 BTS for 1 TESTUSDA.  That 33 BTS per 1 TESTUSDA is the MSSR price which equals the median feed price of 30 BTS per 1 TESTUSDA multiplied by the MSSR of 1.1.  The 165 BTS were withdrawn not from the liquid account of tester-a but instead from tester-a's loan collateral which was previously at 835 BTS and backing 22.78 TESTUSDA.  Its equivalent is 83500000 BTS-satoshis and 227800 TESTUSDA-satoshis.  After the margin call is partly filled by matching with the limit order that was introduced by tester-b, that loan collateral is reduced to 670 BTS and with the outstanding debt reduced to 17.78 TESTUSDA.  See  Loan 1.8.0 in the output of <code>get_call_orders</code>.</p>
<pre><code>unlocked &gt;&gt;&gt; get_call_orders TESTUSDA 5                          
get_call_orders TESTUSDA 5
[{
    "id": "1.8.1",
    "borrower": "1.2.24",
    "collateral": 40000000,
    "debt": 100000,
    "call_price": {
    "base": {
        "amount": 1600,
        "asset_id": "1.3.0"
    },
    "quote": {
        "amount": 7,
        "asset_id": "1.3.1"
    }
    }
},{
    "id": "1.8.0",
    "borrower": "1.2.23",
    "collateral": 67000000,
    "debt": 177800,
    "call_price": {
      "base": {
        "amount": 3350000,
        "asset_id": "1.3.0"
      },
      "quote": {
        "amount": 9779,
        "asset_id": "1.3.1"
      }
    }
  }
]
</code></pre>
<p><strong>Under pre-HF1270 code</strong>, the order by trader-b was matched against an open margin call order against trader-a's loan even though it should not have been margin called because the MCR had been reduced and should have cancelled the margin call for that loan.  If it had been cancelled it would not have been matched against trader-b's limit order.</p>
<p><strong>Under post-HF1270 code</strong>, the order by trader-b should not be matched against trader-a's loan because trader-a's loan should no longer be callable.</p>
<h2 id="4-feed-publisher-reset-the-mcr-to-175-and-the-feed-price-to-the-initial-feed-price">4. Feed Publisher: Reset the MCR to 1.75 and the feed price to the initial feed price</h2>
<p>Before exiting this scenario, clean up the state of the blockchain by re-publishing the initial feed price and MCR values.</p>
<pre><code> publish_asset_feed publisher-a TESTUSDA {"settlement_price":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":2000000,"asset_id":"1.3.0"}},"maintenance_collateral_ratio":1750,"maximum_short_squeeze_ratio":1100,"core_exchange_rate":{"base":{"amount":10000,"asset_id":"1.3.1"},"quote":{"amount":1900000,"asset_id":"1.3.0"}}} true
</code></pre>
<p>Note that the loans by tester-a and tester-b are still outstanding.  Cleaning them up will require the paying back of their loans.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>